@using Хоризонти.Models

@model DestinationSearchViewModel

@{
    ViewData["Title"] = "Всички дестинации";

    string query = Context.Request.Query["query"];
    string minPrice = Context.Request.Query["minPrice"];
    string maxPrice = Context.Request.Query["maxPrice"];
}

<style>
    .destinations-page {
        min-height: 100vh;
        padding: 3rem 0 4rem;
        background: radial-gradient(circle at 0 0, #e3f9e5 0, #f4fbff 40%, #e7f5ff 100%);
        font-family: "Segoe UI", system-ui, sans-serif;
    }

    .destinations-shell {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1.5rem;
    }

    .toolbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: rgba(255,255,255,0.65);
        backdrop-filter: blur(10px);
        padding: 1rem 1.4rem;
        border-radius: 18px;
        box-shadow: 0 14px 35px rgba(0,0,0,0.08);
        margin-bottom: 2rem;
        animation: fadeDown .6s ease-out;
    }

    .toolbar-search {
        flex: 1;
        position: relative;
        max-width: 380px;
    }

    .search-input {
        width: 100%;
        padding: 0.8rem 1.1rem;
        border-radius: 12px;
        border: 1px solid #c7dcd3;
        box-shadow: 0 3px 12px rgba(0,0,0,0.05);
        outline: none;
        transition: 0.25s;
    }

        .search-input:focus {
            border-color: #2ecc71;
            box-shadow: 0 0 12px rgba(46, 204, 113, 0.35);
        }

    .search-btn {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        padding: 0.45rem 1rem;
        background: #2ecc71;
        border-radius: 8px;
        color: white;
        border: none;
        font-weight: 600;
        cursor: pointer;
    }

        .search-btn:hover {
            background: #27ae60;
        }

    .toolbar-filters {
        display: flex;
        gap: 8px;
        align-items: center;
    }

    .filter-input {
        width: 120px;
        padding: 0.55rem 0.7rem;
        border-radius: 10px;
        border: 1px solid #bed7cc;
    }

    .filter-btn {
        padding: 0.55rem 1rem;
        border-radius: 10px;
        background: #2e7d32;
        color: white;
        border: none;
        font-weight: 600;
        cursor: pointer;
    }

    .filter-reset {
        padding: 0.55rem 1rem;
        border-radius: 10px;
        background: #9e9e9e;
        color: white;
        border: none;
        font-weight: 600;
        text-decoration: none;
    }

    .destination-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.9rem;
    }

    .destination-card {
        border-radius: 24px;
        overflow: hidden;
        background: white;
        box-shadow: 0 18px 40px rgba(15,81,40,0.18);
        transition: 0.35s;
    }

        .destination-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 28px 55px rgba(25,60,30,0.25);
        }

    .destination-image {
        width: 100%;
        height: 230px;
        object-fit: cover;
        transition: 0.4s;
    }

    .destination-body {
        padding: 1.4rem 1.6rem;
    }

    .destination-name {
        font-size: 1.35rem;
        font-weight: 700;
        color: #163827;
        margin-bottom: 0.3rem;
    }

    .btn-details {
        display: inline-block;
        margin-top: 1rem;
        background: #1e88e5;
        color: white;
        padding: 0.55rem 1.2rem;
        border-radius: 999px;
        font-weight: 600;
        text-decoration: none;
    }
</style>

<div class="destinations-page">
    <div class="destinations-shell">

        @await Html.PartialAsync("_NatureCategoriesPartial")

        <div class="toolbar">

            <div class="toolbar-search">
                <form method="get" asp-action="Index" asp-controller="Destination">
                    <input type="text"
                           name="query"
                           class="search-input"
                           placeholder="Търси дестинация по име..."
                           value="@query" />
                    <button class="search-btn">Търси</button>
                </form>
            </div>

            <div class="toolbar-filters">
                <form method="get" asp-action="Index" asp-controller="Destination" style="display:flex; gap:8px;">

                    <input type="hidden" name="query" value="@query" />

                    <input type="number"
                           name="minPrice"
                           class="filter-input"
                           placeholder="Мин. цена"
                           value="@minPrice"
                           step="0.01" />

                    <input type="number"
                           name="maxPrice"
                           class="filter-input"
                           placeholder="Макс. цена"
                           value="@maxPrice"
                           step="0.01" />

                    <button type="submit" class="filter-btn">Филтрирай</button>

                    <a asp-action="Index" class="filter-reset">Изчисти</a>
                </form>
            </div>

        </div>

        <div class="destination-grid">
            @foreach (var item in Model.Results)
            {
                <div class="destination-card">
                    <img class="destination-image" src="@item.ImageUrl" alt="@item.Name" />

                    <div class="destination-body">
                        <div class="destination-name">@item.Name</div>

                        <div class="destination-meta">
                            <strong>Терен:</strong> @item.Terrain
                        </div>

                        <a asp-controller="Destination"
                           asp-action="Details"
                           asp-route-id="@item.Id"
                           class="btn-details">
                            Детайли
                        </a>
                    </div>
                </div>
            }
        </div>

    </div>
</div>
